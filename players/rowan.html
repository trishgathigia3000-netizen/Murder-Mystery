<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Rowan Vale ‚Äî Apprentice</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css"></head>
<body>
  <div class="character-page">
    <div class="char-header">
      <div>
        <div class="char-title">Rowan Vale</div>
        <div class="char-role">The Apprentice</div>
        <div class="cryptic">‚ÄúLoyalty always comes at a price. Whose will you pay tonight?‚Äù</div>
      </div>
    </div>

    <div class="two-col">
      <div class="col">
        <div class="section">
          <h3>Backstory</h3>
          <p>Rowan apprenticed under Avery for five years, running the small details and earning quiet loyalty. Being passed over left a bruise that never quite healed. Rowan is practical, watchful, and sometimes too quiet for comfort.</p>
        </div>
      <div class="section" id="guilt-slip" style="margin-top:20px;">
        <button onclick="drawSlip()" style="padding:10px 20px;background:#900;color:#fff;border:none;font-family:'Creepster';">
          Draw Your Slip
        </button>
        <p id="slip-result" style="margin-top:10px;font-size:18px;color:#eee;"></p>
      </div>
</script>
        <div class="section connections">
          <h3>Connections</h3>
          <ul>
            <li><strong>Emery Vale</strong> ‚Äî sibling and protector.</li>
            <li><strong>Eden Larke</strong> ‚Äî replacement; obvious tension.</li>
            <li><strong>Sasha Mirelle</strong> ‚Äî quiet ally in admin.</li>
            <li><strong>Samir Quinn</strong> ‚Äî resents the sponsor's influence.</li>
          </ul>
        </div>
      </div>

      <div class="col">
        <div class="section">
          <h3>Outfit Vibe</h3>
          <p class="outfit">Sharp, understated ‚Äî dark trousers, suspenders or flowing simple cuts with one striking accessory hinting at old-fashioned loyalty.</p>
        </div>

        <div class="section">
          <h3>Props & Evidence</h3>
          <p class="prop">Laptop printout: "Meet 11:30 PM ‚Äî last chance." Kept secret, this is explosive.</p>
        </div>

        <div class="section chart-links">
          <h3>Explore Relations</h3>
          <a href="chart.html?char=Rowan%20Vale&type=family">Family</a>
          <a href="chart.html?char=Rowan%20Vale&type=financial">Financial</a>
          <a href="chart.html?char=Rowan%20Vale&type=rivalry">Rivalry</a>
          <a href="chart.html?type=all">Full Web</a>
        </div>
      </div>
    </div>

    <div class="footer"><a class="back" href="index.html">‚Üê Back to Lobby</a></div>
  </div>
<script type="module">
  import { db } from './js/firebase.js';
  import { ref, onValue } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

  const playerName = "Rowan Vale"; //

  // Draw Your Slip
  function drawSlip() {
    const slipResult = document.getElementById("slip-result");
    if (!slipResult) return;

    const guiltyRef = ref(db, 'guilty');
    onValue(guiltyRef, (snapshot) => {
      const data = snapshot.val();
      if (!data) {
        slipResult.innerText = "Waiting for the host to choose the guilty...";
      } else if (data.name === playerName) {
        slipResult.innerText = "You are GUILTY. Follow the guilty script.";
      } else {
        slipResult.innerText = "You are INNOCENT. Protect your secrets.";
      }
    }, { onlyOnce: true });
  }

  // Listen for Broadcasts
  const broadcastRef = ref(db, 'broadcast');
  onValue(broadcastRef, (snapshot) => {
    const data = snapshot.val();
    if (data && data.message) {
      alert("üì¢ Broadcast: " + data.message);
    }
  });

  // Listen for Clues (array)
  const cluesRef = ref(db, 'clues');
  onValue(cluesRef, (snapshot) => {
    const data = snapshot.val() || [];
    const latest = data[data.length - 1];
    if (latest && latest.message) {
      alert("üîé Clue: " + latest.message);
    }
  });

  // Optional: log guilty for dev/debug
  const guiltyRef = ref(db, 'guilty');
  onValue(guiltyRef, (snapshot) => {
    const data = snapshot.val();
    if (data) console.log("ü§´ Guilty is " + data.name);
  });
</script>
</body></html>